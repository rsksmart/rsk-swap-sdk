# Rsk Swap SDK
[![OpenSSF Scorecard](https://api.scorecard.dev/projects/github.com/rsksmart/rsk-swap-sdk/badge)](https://scorecard.dev/viewer/?uri=github.com/rsksmart/rsk-swap-sdk)
[![CodeQL](https://github.com/rsksmart/rsk-swap-sdk/workflows/CodeQL/badge.svg)](https://github.com/rsksmart/rsk-swap-sdk/actions?query=workflow%3ACodeQL)
[![CI](https://github.com/rsksmart/rsk-swap-sdk/actions/workflows/ci.yml/badge.svg)](https://github.com/rsksmart/rsk-swap-sdk/actions/workflows/ci.yml)

Rsk Swap SDK acts eases the integration between client applications and the RSK Swap API. Which is an aggregator that providers several ways to perform swaps to obtain RBTC through different 3rd party providers.

## Installation
    npm install @rsksmart/rsk-swap-sdk

## Usage
Create RskSwapSDK client instance. For this SDK, the blockchain connection is mandatory. There are 3 ways to create an RSK connection, you can check them in [BlockchainConnection class](TODO url) documentation.
```javascript
    const blockchainConnection: BlockchainConnection = await BlockchainConnection.createUsingStandard(window.ethereum)
    const sdk: RskSwapSDK = new RskSwapSDK('Local', blockchainConnection)
```

To know which providers can facilitate a specific swap you should perform an estimation
```javascript
    const amount = 250_000_000
    const estimations = await sdk.estimateSwap({
        fromChainId: '1',
        toChainId: '30',
        fromToken: 'ETH',
        toToken: 'RBTC',
        fromAmount: amount
    })
```

Then, once you know which provider to use, you can start doing operations with the client by indicating the `providerId`
```javascript
    const args: CreateSwapArgs = {
      fromAmount: amount,
      fromToken: 'ETH',
      toToken: 'RBTC',
      toNetwork: '30',
      fromNetwork: '1',
      providerId: estimations[1].providerId,
      address: '<your address>',
      refundAddress: '<your address>'
    }
    const result = await sdk.createNewSwap(args)
```

Finally, the created swap will contain a [SwapAction](TODO url) indicating the SDK the required actions to perform your swap.
```javascript
    const txHash = await sdk.executeSwap(result.action)
    const receipt = await blockchainConnection.getTransactionReceipt(txHash)
```

Depending on your provider, the swap might not arrive automatically to your wallet. In that case a claim transaction is required, this information will be available in the [SwapAction](TODO url) object.
```javascript
    if (result.action.requiresClaim) {
        const claimTxHash = await sdk.claimSwap(result)
    }
```

> :warning: The [swap object](TODO url) contains a context field with all the information specific to the provider performing the swap. It's very important that the SDK consumer stores this object securely as it might contain private information used to claim or refund swaps. E.g. private keys for atomic swaps. It's also important to remark that when this is the case,
the private information is always securely generated by the SDK in client side and is **not** sent to the server.

## Configuration
This SDK only requires the [BlockchainConnection class](TODO url) instance and the environment name to be used. Regarding the BlockchainConnection it mustn't be readonly as the SDK will try to broadcast transactions during the execute step.

## Application Programming Interface
To see the full API of this package please refer to the [the docs folder](./docs/) of this project